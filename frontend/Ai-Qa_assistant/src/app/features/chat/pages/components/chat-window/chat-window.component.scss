// 1. Ensure the wrapper truly fills the screen
.main-wrapper {
  height: 100vh;
  width: 100vw;
  margin: 0;
  padding: 0;
  display: flex;
  background: #f4f7f6;
  overflow: hidden; // Prevents accidental double scrollbars
}

.chat-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%; 
  background: #ffffff;
}

.chat-header {
  padding: 15px 1%;
  background: #ffffff;
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  h2 { 
    margin: 0; 
    font-size: 1.1rem; 
    font-weight: 600;
    color: #333; 
  }
}

.scroll-area {
  flex: 1; 
  overflow-y: auto;
  padding: 20px 1%; 
  display: flex;
  flex-direction: column;
  gap: 20px;
  background: #f9f9f9;

  @media (max-width: 768px) {
    padding: 20px;
  }
}

.message-row {
  display: flex;
  width: 100%;
  &.user-row { justify-content: flex-end; }
}

.bubble {
  max-width: 75%;
  padding: 15px 20px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.6;

  &.assistant {
    background: #ffffff;
    color: #333;
    border: 1px solid #eaeaea;
    border-bottom-left-radius: 4px;
    
    ::ng-deep {
      pre {
        background: #1e1e1e !important; 
        color: #dcdcdc;
        padding: 16px;
        border-radius: 10px;
        margin: 15px 0;
      }
      code { font-family: 'Consolas', monospace; color: #4ec9b0; }
      h3 { color: #007bff; margin-bottom: 10px; }
    }
  }

  &.user {
    background: #007bff; 
    color: white;
    border-bottom-right-radius: 4px;
    box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2);
  }

  // --- UPDATED TYPING DOTS SECTION ---
  &.typing {
    display: flex;
    align-items: center;
    gap: 5px;
    min-height: 45px;
    padding: 0px 20px;
    background: #f0f0f0; // Subtle grey for the thinking bubble

    .dot {
      width: 8px;
      height: 8px;
      background: #007bff; // Match your theme blue
      border-radius: 50%;
      opacity: 0.4;
      animation: dots 1.4s infinite ease-in-out;

      &:nth-child(2) { animation-delay: 0.2s; }
      &:nth-child(3) { animation-delay: 0.4s; }
    }
  }
}

// Animation for the dots
@keyframes dots {
  0%, 100% { transform: translateY(0); opacity: 0.4; }
  50% { transform: translateY(-5px); opacity: 1; }
}

.input-area {
  padding: 20px 1%;
  background: #ffffff;
  border-top: 1px solid #eee;
  display: flex;
  gap: 12px;
  align-items: center;

  @media (max-width: 768px) {
    padding: 15px;
  }

  textarea {
    flex: 1;
    border: 1px solid #e0e0e0;
    border-radius: 30px;
    padding: 12px 25px;
    outline: none;
    resize: none;
    background: #fcfcfc;
    &:focus { border-color: #007bff; }
  }

  button {
    background: #007bff;
    color: white;
    border: none;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    &:hover { transform: scale(1.05); }
    &:disabled { background: #ccc; }
  }
}
/* Use ::ng-deep to force styles into the markdown component */
::ng-deep {
  .code-toolbar {
    position: relative;
    display: block;

    .copy-to-clipboard-button {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 6px !important;
      background: #007bff !important; // Theme blue
      color: white !important;
      border-radius: 5px !important;
      border: none !important;
      font-size: 12px !important;
      cursor: pointer !important;
      opacity: 1 !important; // Force visibility
      z-index: 10;
      
      span {
        color: white !important;
      }
    }
  }
}